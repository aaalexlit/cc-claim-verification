import torch
from transformers import AutoTokenizer, pipeline, RobertaForSequenceClassification
from codetiming import Timer

climatebert_tokenizer = AutoTokenizer.from_pretrained("climatebert/distilroberta-base-climate-f")
climate_attention_model = RobertaForSequenceClassification.from_pretrained('kruthof/climateattention-ctw',
                                                                           num_labels=2)


@Timer(text="Is climate related elapsed time: {seconds:.0f} s")
def is_about_climate(texts):
    device = 0 if torch.cuda.is_available() else -1
    pipe = pipeline("text-classification", model=climate_attention_model,
                    tokenizer=climatebert_tokenizer, device=device,
                    truncation=True, padding=True)
    labels = []
    probs = []
    for out in pipe(texts, batch_size=64):
        labels.append(out['label'])
        probs.append(out['score'])
    return labels, probs


if __name__ == '__main__':
    print(is_about_climate([
        'Global warming first became evident beyond the bounds of natural variability in 1970s, but increases global mean surface temperatures have stalled 2000s. Increases atmospheric greenhouse gases, notably carbon dioxide, create an energy imbalance at top-of-atmosphere (TOA) even as planet warms to adjust this imbalance, which is estimated be 0.5–1 W m−2 over Annual fluctuations TOA up 0.2 W m−2 occur from variations clouds, aerosols, and changes Sun. At times major volcanic eruptions effects can much larger. Yet fluctuate more than these account for. An manifested not just or ground also melting sea land ice, heating oceans. More 90% heat goes into oceans and, with causes level rise. For past decade, 30% has apparently penetrated below 700 m depth that traceable winds mainly Pacific association a switch negative phase Decadal Oscillation (PDO) 1999. Surface was evidence during 1976–1998 positive PDO, suggesting decadal modulates rate change while sea-level rise relentless. stopped; it merely different ways.',
        'Dioecious plant species represent an important component of terrestrial ecosystems. Yet, little is known about sex-specific responses to drought and elevated temperatures. Populus cathayana Rehd, which a dioecious, deciduous tree species, widely distributed in the northern, central southwestern regions China, was employed as model our study. In closed-top chamber experiments, morphological, physiological biochemical P. different temperatures were investigated. Compared with controls, significantly decreased growth net photosynthesis rate (A), increased intrinsic water use efficiency (WUE(i)), carbon isotope composition (delta13C), malondialdehyde (MDA) abscisic acid (ABA) contents droughted plants. contrast, promoted A, but WUE(i), delta13C, MDA ABA well-watered individuals. When compared males, induced females express greater increase height (HG), basal diameter (BD), leaf area (LA), total number leaves (TNL), dry matter accumulation (DMA) specific (SLA), lower decrease A value, transpiration (E), stomatal conductance (g(s)), contents, while drought-stressed exhibit values HG, BD, LA, TNL, DMA, E, g(s) intercellular CO2 concentration (C(i)), higher levels SLA, contents. Our results indicated that female individuals are more responsive suffer from negative effects than do males when grown under environments stress temperature.',
        'Papilio canadensis encounters shorter, cooler summers in interior Alaska than northern Michigan: average thermal sums are 583 vs. 985 Celsius degree—days (10°C base); mean daily temperature is 14.4 18.8°. The physiology of P. could be evolutionarily conserved, or the species may a composite regionally adapted populations. We evaluated these hypotheses by comparing developmental from and Michigan across range temperatures laboratory field. Higher generally resulted more rapid larval development, but effects varied with insect population host. At low (12°), Alaskan larvae grew faster (fifth instars doubled their fresh mass 5.8 9.1 d), primarily due to 40% higher consumption rates. high (30°), slower, faster, same as larvae, depending upon Effects host quality were greatest at temperatures. Elevated respiratory expenses (35% larvae) made them especially sensitive Dry matter digestibility nitrogen use efficiency differed hosts, not between populations Molting accounted for 35—51% development time. completed fifth molt 12° (11.8 17.8 30° (3.1 2.9 d). In both populations, was growth (Q10 5.65 3.04 12 18°), less 1.60 2.06 18 30°). Survival temperatures, Under ideal basking conditions, field able elevate body °10° above ambient, such conditions rare usually near ambient temperature. no better selecting radiation microsites converting solar into heat. Growth rates when fed foliage exposed air incorporated responses life history model, then used 48—yr climatic record evaluate fitness contributions apparent adaptations summers. On good host, had an estimated 3.0 times greater canadensis. Furthermore, predicted go extinct 31 48 yr Changes contribution enhanced Alaska, followed increased neonates, molting abilities reduced size threshold pupation. Analysis trade—offs suggested that extreme have been important shaping adaptive responses. Regional adaptation climate allows maintain broader geographic distribution would otherwise possible, limits probably still constrained summer',
        'Species diversity is a major determinant of ecosystem productivity, stability, invasibility, and nutrient dynamics. Hundreds studies spanning terrestrial, aquatic, marine ecosystems show that high-diversity mixtures are approximately twice as productive monocultures the same species this difference increases through time. These impacts higher have multiple causes, including interspecific complementarity, greater use limiting resources, decreased herbivory disease, nutrient-cycling feedbacks increase stores supply rates over long term. experimentally observed effects consistent with predictions based on variety theories share common feature: All trade-off-based mechanisms allow long-term coexistence many different competing species. Diversity loss has an effect great as, or than, herbivory, fire, drought, nitrogen addition, elevated CO 2 , other drivers environmental change. The preservation, conservation, restoration biodiversity should be high global priority.',
        'All terrestrial ecosystems consist of aboveground and belowground components that interact to influence community- ecosystem-level processes properties. Here we show how these are closely interlinked at the community level, reinforced by a greater degree specificity between plants soil organisms than has been previously supposed. As such, communities can be powerful mutual drivers, with both positive negative feedbacks. A combined aboveground-belowground approach ecosystem ecology is enhancing our understanding regulation functional significance biodiversity environmental impacts human-induced global change phenomena.',
        'The causes of antibiotic resistance are complex and include human behaviour at many levels society; the consequences affect everybody in world. Similarities with climate change evident. Many efforts have been made to describe different facets interventions needed meet challenge. However, coordinated action is largely absent, especially political level, both nationally internationally. Antibiotics paved way for unprecedented medical societal developments, today indispensible all health systems. Achievements modern medicine, such as major surgery, organ transplantation, treatment preterm babies, cancer chemotherapy, which we take granted, would not be possible without access effective bacterial infections. Within just a few years, might faced dire setbacks, medically, socially, economically, unless real global actions immediately taken. Here, situation resistance, its consequences, identify key areas urgently needed.']))
    # print(is_about_climate(["Earth's natural systems represent a growing threat to human health. And yet, global health has mainly improved as these changes have gathered pace. What is the explanation? As Commission, we are deeply concerned that explanation straightforward and sobering: been mortgaging of future generations realise economic development gains in present. By unsustainably exploiting nature's resources, civilisation fl ourished but now risks substantial eff ects from degradation life support future. Health environment including climatic change, ocean acidifi cation, land degradation, water scarcity, overexploitation fi sheries, biodiversity loss pose serious challenges past several decades likely become increasingly dominant during second half this century beyond. These striking trends driven by highly inequitable, ineffi cient, unsustainable patterns resource consumption technological development, together with population growth. We identify three categories be addressed maintain enhance face harmful environmental trends. Firstly, conceptual empathy failures (imagination challenges), such an over-reliance on gross domestic product measure progress, failure account for harms over present day gains, disproportionate ect those poor developing nations. Secondly, knowledge (research information address social drivers ill health, historical scarcity transdisciplinary research funding, unwillingness or inability deal uncertainty within decision making frameworks. Thirdly, implementation (governance how governments institutions delay recognition responses threats, especially when faced uncertainties, pooled common time lags between action ect. Although better evidence needed underpin appropriate policies than available at present, should not used excuse inaction. Substantial potential exists link reduce damage outcomes nations all levels development. This Commission identifi es opportunities six key constituencies: professionals, funders academic community, UN Bretton Woods bodies, governments, investors corporate reporting civil society organisations. Depreciation capital subsidy accounted so economy nature falsely separated. Policies balance sustainability, economy. To world 9-10 billion people more, resilient food agricultural both undernutrition overnutrition, waste, diversify diets, minimise damage. Meeting need modern family planning can improve short termeg, reduced maternal mortality pressures infrastructure. Planetary off ers unprecedented opportunity advocacy national reforms taxes subsidies many sectors economy, energy, agriculture, water, Regional trade treaties act further incorporate protection near long term. Several essential steps taken transform planetary include reduction waste through creation products more durable require less energy materials manufacture often produced present; incentivisation recycling, reuse, repair; substitution hazardous safer alternatives. Despite limitations, Sustainable Development Goals provide great integrate sustainability judicious selection relevant indicators wellbeing, enabling infrastructure supporting systems, strong governance. The landscape, ecosystems, they contain managed protect indirectly, disease risk. Intact restored ecosystems contribute resilience (see panel 1 glossary terms report), example, coastal (eg, wave attenuation) ability oodplains greening river catchments ooding events diverting holding excess water. growth urban populations emphasises importance environment, air pollution, increased physical activity, provision green space, prevent sprawl decrease magnitude heat islands. Transdisciplinary activities capacity urgent expansion. Present limitations action. In situations where technology deliver win-win solutions co-benefi ts, rapid scale-up achieved if researchers move ahead assess solutions. Recent scientifi c investments towards understanding non-linear state shifts very important, absence predictability changes, orts adaptation strategies remain priority. integrated surveillance collect rigorous socioeconomic, data defi ned periods early detection emerging outbreaks nutrition non-communicable burden. improvement risk communication policy makers public make evidence-informed decisions helped do systematic reviews briefs. professionals role achievement health: working across advance tackling inequities, reducing impacts increasing change. Humanity stewarded successfully 21st addressing unacceptable inequities wealth limits Earth, will generation new knowledge, wise policies, decisive action, inspirational leadership."]))